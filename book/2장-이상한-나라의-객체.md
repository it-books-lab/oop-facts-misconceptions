# 2장. 이상한 나라의 객체

- 객체란 무엇인가?
- 객체는 상태와 행동, 식별자를 가진 존재.

---

## 1. 객체지향과 인지 능력

- 객체란 인간이 분명하게 인지하고 구별할 수 있는 물리적인 또는 개념적인 경계를 지닌 어떤 것이다.

## 2. 객체, 그리고 이상한 나라

- 이상한 나라의 앨리스의 특징 요약
    - 앨리스는 상태(몸의 크기)를 가지며 변경 가능하다.
    - 앨리스의 상태를 변경시키는 것은 앨리스의 행동이다.
        - 행동의 결과는 상태에 의존적이며 상태를 이용해 서술할 수 있다.
        - 행동의 순서가 결과에 영향을 미친다.
    - 앨리스는 어떤 상태에 있더라도(상태 변경과 무관하게) 유일한 존재로 식별 가능하다.

## 3. 객체, 그리고 소프트웨어 나라

- 객체란 식별 가능한 개체 또는 사물이다.
- 객체는 자동차처럼 만질 수 있는 구체적인 사물일 수도 있고, 시간처럼 추상적인 개념일 수도 있다.
- 객체는
    - 구별 가능한 식별자,
    - 특징적인 행동,
    - 변경 가능한 상태
    
    를 가진다.
    
- 소프트웨어 안에서 객체는 저장된 상태와 실행 가능한 코드를 통해 구현된다.

### 상태

**왜 상태가 필요한가?**

- 객체가 주변 환경과의 상호작용에 “어떻게 반응하는가”는 “그 시점까지 객체에 어떤 일이 발생했는냐(=과거 행동 이력)”에 좌우된다.
- 하지만, 과거에 발생한 행동의 이력을 통해 현재 발생한 행동의 결과를 판단하는 방식은 복잡하고 번거로우며 이해하기 어려움.
- → 따라서, 인간의 행동의 과정과 결과를 단순하게 기술하기 위해 상태라는 개념을 고안.
- Ex.
    - 비행기  → 항공권의 발권 상태
    - 자판기  → 현재까지 투입된 금액의 상태
    - 앨리스의 키만 알면 문을 통과할 수 있는지 여부를 쉽게 판단할 수 있다.

---

**상태와 프로퍼티**

- 이상한 나라의 앨리스에 앨리스, 버섯, 토끼, 음료, 케이크 등은 객체이다.
- 하지만 케이크의 크기, 앨리스의 키 등은 객체가 아니다. 즉, 숫자, 문자열, 양, 속도, 시간, 날짜, 참/거짓과 같은 단순한 값들은 객체가 아니다.
- 때로는 단순한 값이 아니라 객체를 사용해 다른 객체의 상태를 표현해야 할 때가 있다.
    - 앨리스가 현재 음료를 들고 있는 상태인지 표현하고 싶다면?
    - → 앨리스의 상태 일부를 음료라는 객체를 이영해 표현!
- 이때, 객체의 상태를 구성하는 모든 특징을 통틀어 객체의 프로퍼티(property)라고 한다.
- ex. 앨리스의 키, 위치, 음료
- 일반적으로 property는 변경되지 않고 = 정적이다.
- property의 값은 변경된다. = 동적이다.

<img width="1382" height="269" alt="image" src="https://github.com/user-attachments/assets/68cde7e4-8524-47ea-8919-7ddf43de35fc" />

- 앨리스가 음료를 가지고 있다. = 링크로 연결
    - 객체와 객체 사이의 의미 있는 연결 = 링크

<img width="1179" height="232" alt="image" src="https://github.com/user-attachments/assets/45d02d11-dd18-4ad3-a299-e35b0855418c" />

- 앨리스가 음료를 마시고 버리자
    - 키가 줄었고,
    - 음료와의 링크가 끊어진다.
- 링크가 있어야만 요청/응답/메시지를 주고 받을 수 있다.
- 링크는 객체가 다른 객체를 참조할 수 있다는 것을 의미한다. 한 객체가 다른 객체의 식별자를 알고 있는 것으로 표현된다.

---

- 객체 간의 선으로 표현되는 링크와 달리 객체를 구성하는 단순한 값은 속성(attribute)이라고 한다.
- 앨리스의 키, 위치 = 속성
- 음료 = 다른 객체의 식별자 (링크)
- 즉, property는 단순한 값인 속성과 다른 객체를 가리키는 링크라는 두 가지 종류의 조합으로 표현한다.

---

- 상태는 “특정 시점에 객체가 가지고 있는 정보의 집합”으로 객체의 구조적 특징을 표현한다.
- 객체의 상태는 객체에 존재하는 “정적인 프로퍼티”와 “동적인 프로퍼티의 값”으로 구성된다.
- 객체의 프로퍼티는 “단순한 값(속성)”과 “다른 객체를 참조하는 “링크”로 구분할 수 있다.

---

- 객체는 자율적인 존재이다.
- = 객체는 다른 객체의 상태에 직접적으로 접근할 수도, 상태를 변경할 수도 없다.
- = 따라서, 외부의 객체는 간접적으로 다른 객체의 상태를 변경하거나 조회할 수 있는 방법이 필요하다. → 이게 바로 “행동”

### 행동

**상태와 행동**

- 객체의 상태는 저절로 변경되지 않는다. 객체의 자발적인 행동이 상태를 바꾼다.
- 객체의 행동은 객체의 상태를 변경시키지만, 행동의 결과는 객체의 상태에 의존적이다.
    - 음료를 마시기 전 앨리스의 키보다 작아져야 함. = 앨리스의 키에 의존적인 행동 결과
- 상태와 행동 사이의 관계
    - 객체의 행동은 상태에 영향을 받는다. → 어떤 방식으로 의존하는가?
    - 객체의 행동은 상태를 변경시킨다. → 어떻게 변경시키는가?
- Ex. 문의 크기 40cm
    - 앨리스의 키가 40이하면 문 통과 가능
    - 문 통과 시 앨리스의 위치를 정원으로 바꾼다.

---

**협력과 행동**

- 객체의 행동은 두 가지 관점의 부수효과를 명확하게 서술해야 한다.
    - 객체 자신의 상태 변경
    - 행동 내에서 협력하는 다른 객체에 대한 메시지 전송
- 행동 정의
    - 행동이란 외부의 요청 또는 수신된 메시지에 응답하기 위해 동작하고 반응하는 활동이다.
    - 행동의 결과로 객체는 자신의 상태를 변경하거나 다른 객체에게 메시지를 전달할 수 있다.
    - 객체는 행동을 통해 다른 객체와의 협력에 참여하므로 행동은 외부에 가시적이어야 한다.

---

**상태 캡슐화**

- 현실 세계의 객체와 객체지향 세계의 객체의 차이점
    - 현실 세계에서 앨리스는 능동적인 인간, 음료는 수동적인 사물이다.
    - 하지만, 객체지향 세계에서 앨리스는 음료의 양을 줄일 수 없다. 음료를 마셨다는 메시지를 전달할 뿐이다. 그러면 음료는 스스로 자신의 양을 줄인다.

<img width="1258" height="334" alt="image" src="https://github.com/user-attachments/assets/95b62b86-319a-4926-96d8-e5dfe3abaae8" />

- 객체는 상태를 캡슐 안에 감춰둔 채 외부로 노출하지 않는다.
    - 앨리스가 음료에게 줄어든 양을 인자로 보낸다.
    - 즉, 앨리스는 음료의 양은 알 수 없다.
    - 앨리스는 오직 음료를 마신다는 행동을 통해 음료의 양에 (간접적으로) 접근하는 것이다.
- 음료수가 메시지를 해석하고 그에 반응해 상태(음료의 양)를 변경할 지 여부는 전적으로 메시지 수신자의 자율적인 판단에 따른다.
- 결과적으로 캡슐화하는 것은 객체의 자율성을 높인다. 이는 협력을 단순하고 유연하게 만든다.

### 식별자

- 객체를 서로 구별할 수 있는 프로퍼티(=식별자)가 객체 안에 존재한다.
- 값은 숫자, 문자열, 날짜, 시간, 금액 등과 같이 변하지 않는 양을 모델링한다.
    - = 불변 상태를 가진다.
    - “값”의 경우 두 인스턴스의 “상태”가 같다면 “두 인스턴스를 같은 것”으로 판단한다. = 동등성(=equality=상태를 이용해 두 값이 같은지 판단할 수 있는 성질)
    - ex. 1=1
- 왜 상태를 이용해 동등성을 판단할 수 있냐?
    - → 값의 상태가 변하지 않기 때문에!

- 객체는 시간에 따라 변경되는 상태를 포함하며, 행동을 통해 상태를 변경한다.
    - = 가변 상태를 가진다.
    - “타입이 같은 두 객체”의 “상태”가 완전히 똑같더라도 “두 객체는 독립적인 별개의 객체로” 다뤄야 한다.
    - ex. 이름과 키가 완전히 똑같은 두 사람을 같은 사람이라고 볼 수는 없음.
    - 반면에 두 객체의 상태가 다르더라도 식별자가 같다면 두 객체를 같은 객체로 판단할 수 있다. = 동일성(=identical)
    - 상태를 기반으로 객체의 동일성을 판단할 수 없는 이유?
    - → 시간의 흐름에 따라 객체의 상태가 변하기 때문이다. 어느 한 시점에 두 객페의 상태가 동일하더라도 한 객체의 상태가 변하는 순간 두 객체는 서로 다른 상태가 되어 버린다.
    - 지난 달의 내 몸무게와 다음 달의 내 몸무게가 바뀐다. 지난 달의 나와 다음 달의 나는 다른 사람인가? → No!
- 식별자란 어떤 객체를 다른 객체와 구분하는 데 사용하는 객체의 프로퍼티다.
- 값은 식별자를 가지지 않기 때문에 상태를 이용한 동등성 검사를 통해 두 인스턴스를 비교해야 한다.
- 객체는 상태가 변경될 수 있기 때문에 식별자를 이용한 동일성 검사를 통해 두 인스턴스를 비교할 수 있다.

## 기계로서의 객체

- 객체의 상태를 조회하는 작업 = 쿼리(query)
- 객체의 상태를 변경하는 작업 = 명령(command)

<img width="803" height="435" alt="image" src="https://github.com/user-attachments/assets/ccbaf7c0-1dce-49a3-add1-9cf4d54dc625" />

- 사용자는 기계를 뜯어 내부의 회로를 확인할 수 없다.
- 그저, 버튼을 눌러 행동하는 방법 밖에 없다.
- = 캡슐화

<img width="1240" height="572" alt="image" src="https://github.com/user-attachments/assets/dac9a7e0-4246-4c09-86df-2909a59933b0" />

## 행동이 상태를 결정한다.

- 객체에 필요한 상태를 먼저 결정하고, 행동을 결정하면 안된다.
    - 캡슐화 저해
    - 객체가 고립된 섬이 됨
    - 재사용성 저하
- 행동에 초점을 맞춰 객체를 만든다.(=책임-주도 설계 = Responsibility-Driven Design, RDD)
    - 객체지향 설계는 애플리케이션에 필요한 협력을 생각하고
    - 협력에 참여하는 데 필요한 행동을 생각한 후
    - 행동을 수행할 객체를 선택하는 방식으로 수행된다.
    - 행동을 결정한 후에야 적절한 상태를 선택하게 된다.

### 의인화

- 현실 속의 객체와 소프트웨어 객체 사이의 가장 큰 차이점은
- 현실 속에서는 수동적인 존재가 소프트웨어 객체로 구현될 때는 능동적으로 변한다는 것이다.
- 소프트웨어 객체가 현실 객체의 부분적인 특징을 모방하는 것이 아니라 현실 객체가 가지지 못한 추가적인 능력을 보유하게 된다.

### 은유

### 이상한 나라를 창조하라



